2024-07-21 17:40:10,399 - INFO - 데이터베이스에서 2024-07-13 부터 2024-07-19 까지의 데이터를 추출합니다.
2024-07-21 17:40:10,579 - INFO - Connection pool created successfully
2024-07-21 17:40:10,580 - INFO - Connection acquired from pool
2024-07-21 17:40:10,596 - INFO - Connection returned to pool
2024-07-21 17:40:10,598 - INFO - 총 794개의 데이터가 추출되었습니다.
2024-07-21 17:40:10,627 - INFO - 데이터가 CSV 파일로 저장되었습니다: C:\MyMain\Teckwah\download\xlsx_files_complete\WK24-WK24\2024-07-13_2024-07-19_ReceivingTAT_analysis_full_data.csv
2024-07-21 17:40:10,630 - INFO - 데이터가 CSV 파일로 저장되었습니다: C:\MyMain\Teckwah\download\xlsx_files_complete\WK24-WK24\2024-07-13_2024-07-19_ReceivingTAT_analysis_weekly_analysis.csv
2024-07-21 17:40:10,633 - INFO - 데이터가 CSV 파일로 저장되었습니다: C:\MyMain\Teckwah\download\xlsx_files_complete\WK24-WK24\2024-07-13_2024-07-19_ReceivingTAT_analysis_shipto_analysis.csv
2024-07-21 17:42:28,246 - INFO - 데이터베이스에서 2024-07-13 부터 2024-07-19 까지의 데이터를 추출합니다.
2024-07-21 17:42:28,393 - INFO - Connection pool created successfully
2024-07-21 17:42:28,394 - INFO - Connection acquired from pool
2024-07-21 17:42:28,409 - INFO - Connection returned to pool
2024-07-21 17:42:28,410 - INFO - 총 794개의 데이터가 추출되었습니다.
2024-07-21 17:42:29,384 - INFO - 데이터가 Excel 파일로 저장되었습니다: C:\MyMain\Teckwah\download\xlsx_files_complete\WK24-WK24_ReceivingTAT_analysis.xlsx
2024-07-21 18:08:53,277 - INFO - 데이터베이스에서 2024-07-13 부터 2024-07-19 까지의 데이터를 추출합니다.
2024-07-21 18:08:53,432 - INFO - Connection pool created successfully
2024-07-21 18:08:53,433 - INFO - Connection acquired from pool
2024-07-21 18:08:53,447 - INFO - Connection returned to pool
2024-07-21 18:08:53,448 - INFO - 총 794개의 데이터가 추출되었습니다.
2024-07-21 18:08:53,453 - ERROR - 예상치 못한 오류 발생: name 'file_path' is not defined
Traceback (most recent call last):
  File "c:\MyMain\Teckwah\main\crawling_data\export.py", line 98, in main
    summary_df = pd.read_excel(file_path, sheet_name='Summary')
                               ^^^^^^^^^
NameError: name 'file_path' is not defined
2024-07-21 18:11:35,827 - INFO - Fetching data from 2024-07-13 to 2024-07-19 from the database.
2024-07-21 18:11:35,979 - INFO - Connection pool created successfully
2024-07-21 18:11:35,980 - INFO - Connection acquired from pool
2024-07-21 18:11:35,995 - INFO - Connection returned to pool
2024-07-21 18:11:35,996 - INFO - Fetched 794 records from the database.
2024-07-21 18:11:36,001 - INFO - Data analysis complete.
2024-07-21 18:11:36,003 - ERROR - Unexpected error occurred: [Errno 2] No such file or directory: '/path/to/sample.xlsx'
Traceback (most recent call last):
  File "c:\MyMain\Teckwah\main\crawling_data\export.py", line 110, in main
    summary_df = pd.read_excel(summary_template_path, sheet_name='Summary')
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
         ^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/path/to/sample.xlsx'
2024-07-21 18:14:34,081 - INFO - Received input dates: 2024-07-13 to 2024-07-19
2024-07-21 18:14:34,082 - INFO - Fetching data from 2024-07-13 to 2024-07-19 from the database.
2024-07-21 18:14:34,221 - INFO - Connection pool created successfully
2024-07-21 18:14:34,222 - INFO - Connection acquired from pool
2024-07-21 18:14:34,236 - INFO - Connection returned to pool
2024-07-21 18:14:34,237 - INFO - Fetched 794 records from the database.
2024-07-21 18:14:34,242 - INFO - Data analysis complete.
2024-07-21 18:14:34,242 - INFO - Reading Summary template from path/to/sample.xlsx
2024-07-21 18:14:34,244 - ERROR - Unexpected error occurred: [Errno 2] No such file or directory: 'path/to/sample.xlsx'
Traceback (most recent call last):
  File "c:\MyMain\Teckwah\main\crawling_data\export.py", line 132, in main
    summary_df = pd.read_excel(summary_template_path, sheet_name='Summary')
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
         ^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'path/to/sample.xlsx'
2024-07-21 18:16:17,874 - INFO - Received input dates: 2024-07-13 to 2024-07-19
2024-07-21 18:16:17,875 - INFO - Fetching data from 2024-07-13 to 2024-07-19 from the database.
2024-07-21 18:16:18,019 - INFO - Connection pool created successfully
2024-07-21 18:16:18,019 - INFO - Connection acquired from pool
2024-07-21 18:16:18,033 - INFO - Connection returned to pool
2024-07-21 18:16:18,034 - INFO - Fetched 794 records from the database.
2024-07-21 18:16:18,039 - INFO - Data analysis complete.
2024-07-21 18:16:18,040 - INFO - Reading Summary template from C:/MyMain/Teckwah/download/sample.xlsx
2024-07-21 18:16:18,493 - INFO - Read Summary template successfully.
2024-07-21 18:16:18,493 - INFO - Updating Summary sheet with weekly analysis data.
2024-07-21 18:16:18,496 - ERROR - Error in update_summary_sheet: "['DIRTAJ', 'DIRPUS', 'DIRKWJ'] not in index"
2024-07-21 18:16:18,496 - ERROR - Unexpected error occurred: "['DIRTAJ', 'DIRPUS', 'DIRKWJ'] not in index"
Traceback (most recent call last):
  File "c:\MyMain\Teckwah\main\crawling_data\export.py", line 135, in main
    updated_summary_df = update_summary_sheet(summary_df, analysis_results['weekly_analysis'], analysis_results['shipto_analysis'])
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\MyMain\Teckwah\main\crawling_data\export.py", line 67, in update_summary_sheet
    summary_df.loc[summary_df['CountPO'] == week, 'Total'] = summary_df.loc[summary_df['CountPO'] == week, ['DIRSEL', 'DIRTAJ', 'DIRPUS', 'DIRKWJ']].sum(axis=1)
                                                             ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1184, in __getitem__
    return self._getitem_tuple(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1377, in _getitem_tuple
    return self._getitem_tuple_same_dim(tup)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1020, in _getitem_tuple_same_dim
    retval = getattr(retval, self.name)._getitem_axis(key, axis=i)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['DIRTAJ', 'DIRPUS', 'DIRKWJ'] not in index"
2024-07-21 18:19:35,171 - INFO - Received input dates: 2024-07-13 to 2024-07-19
2024-07-21 18:19:35,172 - INFO - Fetching data from 2024-07-13 to 2024-07-19 from the database.
2024-07-21 18:19:35,312 - INFO - Connection pool created successfully
2024-07-21 18:19:35,312 - INFO - Connection acquired from pool
2024-07-21 18:19:35,328 - INFO - Connection returned to pool
2024-07-21 18:19:35,329 - INFO - Fetched 794 records from the database.
2024-07-21 18:19:35,334 - INFO - Data analysis complete.
2024-07-21 18:19:35,334 - INFO - Reading Summary template from C:\MyMain\Teckwah\download\sample.xlsx
2024-07-21 18:19:35,738 - INFO - Read Summary template successfully.
2024-07-21 18:19:35,738 - INFO - Updating Summary sheet with weekly analysis data.
2024-07-21 18:19:35,740 - ERROR - Error in update_summary_sheet: "['DIRTAJ', 'DIRPUS', 'DIRKWJ'] not in index"
2024-07-21 18:19:35,740 - ERROR - Unexpected error occurred: "['DIRTAJ', 'DIRPUS', 'DIRKWJ'] not in index"
Traceback (most recent call last):
  File "c:\MyMain\Teckwah\main\crawling_data\export.py", line 135, in main
    updated_summary_df = update_summary_sheet(summary_df, analysis_results['weekly_analysis'], analysis_results['shipto_analysis'])
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\MyMain\Teckwah\main\crawling_data\export.py", line 67, in update_summary_sheet
    summary_df.loc[summary_df['CountPO'] == week, 'Total'] = summary_df.loc[summary_df['CountPO'] == week, ['DIRSEL', 'DIRTAJ', 'DIRPUS', 'DIRKWJ']].sum(axis=1)
                                                             ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1184, in __getitem__
    return self._getitem_tuple(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1377, in _getitem_tuple
    return self._getitem_tuple_same_dim(tup)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1020, in _getitem_tuple_same_dim
    retval = getattr(retval, self.name)._getitem_axis(key, axis=i)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['DIRTAJ', 'DIRPUS', 'DIRKWJ'] not in index"
